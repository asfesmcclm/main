<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Calculadora Oficial UGT - Sandbox</title>
    <style>
        :root { 
            --ugt-red: #e30613; 
            --ugt-green: #166534;
            --bg-gray: #f8f9fa; 
            --text-dark: #333;
        }
        
        body { font-family: 'Segoe UI', sans-serif; background: #e9ecef; padding: 15px; color: var(--text-dark); }
        .container { max-width: 600px; margin: auto; }
        .card { background: white; padding: 22px; border-radius: 15px; box-shadow: 0 4px 12px rgba(0,0,0,0.1); margin-bottom: 20px; }
        h3 { color: var(--ugt-red); margin-top: 0; font-size: 1.2rem; border-bottom: 2px solid #eee; padding-bottom: 10px; }
        .form-group { margin-bottom: 18px; }
        label { display: block; font-weight: 700; margin-bottom: 8px; font-size: 0.9rem; }
        input, select { width: 100%; padding: 12px; border: 1px solid #ccc; border-radius: 8px; box-sizing: border-box; font-size: 1rem; }

        .radio-group { display: flex; gap: 15px; background: var(--bg-gray); padding: 10px; border-radius: 8px; margin-bottom: 15px; }
        .radio-group label { font-weight: normal; display: flex; align-items: center; gap: 5px; cursor: pointer; margin-bottom: 0; }

        .info-live { margin-top: 10px; padding: 10px; background: #f0fdf4; border: 1px dashed #bbf7d0; border-radius: 8px; font-size: 0.9rem; color: var(--ugt-green); display: none; }
        
        button { background: var(--ugt-red); color: white; border: none; width: 100%; padding: 16px; border-radius: 10px; font-weight: bold; font-size: 1.1rem; cursor: pointer; transition: 0.3s; }
        button:hover { background: #b3050f; transform: translateY(-1px); }

        /* Estilos de la Tabla de Resultados */
        #resultado { display: none; margin-top: 25px; }
        .res-item { background: white; border-bottom: 1px solid #eee; padding: 15px; display: flex; flex-direction: column; gap: 5px; }
        .res-item:last-child { border-bottom: none; border-radius: 0 0 12px 12px; }
        .res-item:first-child { border-radius: 12px 12px 0 0; }
        .res-header { display: flex; justify-content: space-between; align-items: flex-start; }
        .res-title { font-weight: bold; font-size: 0.95rem; color: #444; max-width: 70%; }
        .res-value { font-weight: 800; color: var(--ugt-red); font-size: 1.1rem; }
        .res-calc { font-size: 0.75rem; color: #777; font-style: italic; }
        .topado-msg { font-size: 0.75rem; color: #d97706; font-weight: bold; }

        .disclaimer { font-size: 0.8rem; color: #666; margin-top: 15px; background: #fff; padding: 15px; border-radius: 10px; border: 1px solid #ddd; }
    </style>
</head>
<body>

<div class="container">
    <div class="card">
        <h3>1. Cronología Laboral</h3>
        <div class="form-group">
            <label>Fecha de inicio del contrato</label>
            <input type="date" id="f_inicio">
        </div>
        <div class="form-group">
            <label>Fecha de finalización / cese</label>
            <input type="date" id="f_fin">
        </div>
        <div id="info_antiguedad" class="info-live">
            Antigüedad detectada: <strong id="val_antiguedad">---</strong>
        </div>
    </div>

    <div class="card">
        <h3>2. Percepciones Salariales</h3>
        <label>Tipo de salario bruto:</label>
        <div class="radio-group">
            <label><input type="radio" name="tipo_s" value="diario"> Diario</label>
            <label><input type="radio" name="tipo_s" value="mensual" checked> Mensual</label>
            <label><input type="radio" name="tipo_s" value="anual"> Anual</label>
        </div>

        <div class="form-group">
            <label>Importe Bruto (€)</label>
            <input type="text" id="s_importe" placeholder="Ej: 1850,50">
        </div>

        <div id="info_salario_anual" class="info-live">
            Salario bruto anual estimado: <strong id="val_salario_anual">---</strong>
        </div>
    </div>

    <button onclick="generarInforme()">GENERAR INFORME COMPARATIVO</button>

    <div id="resultado">
        <h3 style="text-align: center; color: #333; margin-bottom: 10px;">Cuantías Estimadas de Indemnización</h3>
        <div id="lista_indemnizaciones" style="box-shadow: 0 4px 10px rgba(0,0,0,0.1); border-radius: 12px; overflow: hidden;">
            </div>

        <div class="disclaimer">
            <strong>Nota legal:</strong> Estos cálculos aplican los topes de 12, 24 o 9 mensualidades según establece el Estatuto de los Trabajadores. 
            Si tu contrato es anterior a 2012, el cálculo podría ser superior. Acude a tu sede de <strong>UGT</strong> para una revisión detallada.
        </div>
    </div>
</div>

<script>
    // Inicialización
    window.onload = function() {
        const hoy = new Date().toISOString().split('T')[0];
        document.getElementById('f_fin').value = hoy;
        
        document.getElementById('f_inicio').addEventListener('change', actualizarAntiguedad);
        document.getElementById('f_fin').addEventListener('change', actualizarAntiguedad);
        document.getElementById('s_importe').addEventListener('input', actualizarSalario);
        document.querySelectorAll('input[name="tipo_s"]').forEach(r => r.addEventListener('change', actualizarSalario));
    };

    function actualizarAntiguedad() {
        const fi = new Date(document.getElementById('f_inicio').value);
        const ff = new Date(document.getElementById('f_fin').value);
        if (fi.getTime() && ff.getTime()) {
            const dias = Math.floor((ff - fi) / (1000 * 60 * 60 * 24));
            if (dias < 0) return;
            document.getElementById('val_antiguedad').innerText = `${Math.floor(dias/365)} años y ${dias%365} días`;
            document.getElementById('info_antiguedad').style.display = 'block';
        }
    }

    function actualizarSalario() {
        let raw = document.getElementById('s_importe').value.replace(',', '.');
        const imp = parseFloat(raw) || 0;
        const tipo = document.querySelector('input[name="tipo_s"]:checked').value;
        if (imp > 0) {
            let anual = (tipo === 'diario') ? imp * 365 : (tipo === 'mensual' ? imp * 12 : imp);
            document.getElementById('val_salario_anual').innerText = anual.toLocaleString('es-ES', { style: 'currency', currency: 'EUR' });
            document.getElementById('info_salario_anual').style.display = 'block';
        }
    }

    function calcularIndem(sDia, anios, diasAnio, topeMeses) {
        let bruto = sDia * diasAnio * anios;
        let tope = (sDia * 30.42) * topeMeses;
        let final = bruto;
        let topado = false;

        if (bruto > tope && topeMeses > 0) {
            final = tope;
            topado = true;
        }
        return { valor: final, calc: `${diasAnio} días/año`, topado: topado, max: topeMeses };
    }

    function generarInforme() {
        const fi = new Date(document.getElementById('f_inicio').value);
        const ff = new Date(document.getElementById('f_fin').value);
        let raw = document.getElementById('s_importe').value.replace(',', '.');
        const imp = parseFloat(raw) || 0;

        if (!fi.getTime() || !ff.getTime() || imp <= 0) {
            alert("Por favor, completa los datos de fechas y salario.");
            return;
        }

        const tipo = document.querySelector('input[name="tipo_s"]:checked').value;
        const sAnual = (tipo === 'diario') ? imp * 365 : (tipo === 'mensual' ? imp * 12 : imp);
        const sDia = sAnual / 365;
        const anios = (ff - fi) / (1000 * 60 * 60 * 24 * 365.25);

        const casos = [
            { t: "1. DESPIDO IMPROCEDENTE", d: 33, m: 24 },
            { t: "2. EXTINCIÓN POR INCUMPLIMIENTO EMPRESARIO", d: 33, m: 24 },
            { t: "3. DESPIDO OBJETIVO PROCEDENTE", d: 20, m: 12 },
            { t: "4. DESPIDO COLECTIVO PROCEDENTE", d: 20, m: 12 },
            { t: "5. MOVILIDAD GEOGRÁFICA", d: 20, m: 12 },
            { t: "6. MODIFICACIÓN SUSTANCIAL CONDICIONES", d: 20, m: 9 },
            { t: "7. EXTINCIÓN CONTRATO TEMPORAL", d: 12, m: 0 }
        ];

        let html = "";
        casos.forEach(c => {
            let res = calcularIndem(sDia, anios, c.d, c.m);
            html += `
                <div class="res-item">
                    <div class="res-header">
                        <span class="res-title">${c.t}</span>
                        <span class="res-value">${res.valor.toLocaleString('es-ES', {minimumFractionDigits: 2, maximumFractionDigits: 2})} €</span>
                    </div>
                    <div class="res-calc">Cálculo: ${res.calc} ${c.m > 0 ? `(Máximo ${c.m} mens.)` : ''}</div>
                    ${res.topado ? `<div class="topado-msg">⚠️ Alcanzado el máximo legal (${c.m} mensualidades)</div>` : ''}
                </div>
            `;
        });

        document.getElementById('lista_indemnizaciones').innerHTML = html;
        document.getElementById('resultado').style.display = 'block';
        document.getElementById('resultado').scrollIntoView({ behavior: 'smooth' });
    }
</script>

</body>
</html>
