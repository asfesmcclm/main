<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Calculadora de Finiquito - UGT</title>
    <link rel="stylesheet" href="css/estilos.css"> 
    <style>
        /* Ajustes específicos para que combine con tu calculadora */
        .res-item-finiquito {
            padding: 12px;
            border-bottom: 1px solid #eee;
            display: flex;
            justify-content: space-between;
        }
        .total-box {
            background: #f8f9fa;
            border-left: 5px solid var(--ugt-red);
            padding: 15px;
            margin-top: 20px;
            font-size: 1.1rem;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="card" style="text-align: center; border-bottom: 5px solid var(--ugt-red);">
            <h2 style="border:none; margin-bottom:5px;">Cálculo de Finiquito</h2>
            <p style="color: #666; font-size: 0.9rem;">Liquidación de haberes devengados y no percibidos</p>
        </div>

        <div class="card">
            <h3>1. Salario y Mes en curso</h3>
            <div class="form-group">
                <label>Salario Bruto Mensual (€)</label>
                <input type="number" id="f_salario_mes" class="form-control" placeholder="Ej: 1800">
            </div>
            <div class="form-group">
                <label>Días trabajados este mes</label>
                <input type="number" id="f_dias_mes" class="form-control" placeholder="Día del mes en que cesas">
            </div>
        </div>

        <div class="card">
            <h3>2. Vacaciones Pendientes</h3>
            <div class="form-group">
                <label>Días de vacaciones no disfrutados</label>
                <input type="number" id="f_vac_dias" class="form-control" placeholder="Ej: 7.5">
                <small>Días acumulados desde el 1 de enero hasta hoy.</small>
            </div>
        </div>

        <div class="card">
            <h3>3. Pagas Extraordinarias</h3>
            <div class="form-group">
                <label>¿Pagas prorrateadas en nómina?</label>
                <select id="f_pagas_tipo" class="form-control" onchange="togglePagasExtra()">
                    <option value="si">Sí (Ya van incluidas cada mes)</option>
                    <option value="no">No (Cobro aparte Navidad y Verano)</option>
                </select>
            </div>

            <div id="f_bloque_pagas" style="display:none; margin-top:15px; padding-top:15px; border-top: 1px dashed #ccc;">
                <label>Meses generados para la próxima extra</label>
                <input type="number" id="f_meses_paga" class="form-control" placeholder="Meses desde la última paga">
                <small>Habitualmente entre 1 y 6 meses.</small>
            </div>
        </div>

        <button onclick="calcularLiquidacion()" class="btn-primary" style="width:100%; height: 50px; font-weight: bold; font-size: 1rem;">
            GENERAR LIQUIDACIÓN
        </button>

        <div id="f_resultado" class="card" style="display:none; margin-top: 25px;">
            <h3>Detalle del Finiquito</h3>
            <div id="f_lista"></div>
            
            <div class="total-box">
                <span>TOTAL BRUTO A PERCIBIR:</span>
                <strong id="f_total" style="color: var(--ugt-red); float: right;"></strong>
            </div>

            <div id="seccion_hacienda" class="card" style="margin-top:20px; background:#fff9f9; font-size:0.85rem;">
                <button class="btn-close" onclick="UI.cerrarSeccion('seccion_hacienda')">x</button>
                <p></p>
            </div>
        </div>
    </div>

    <script src="js-calculadora/ui.js"></script>
    <script>
        // Al cargar, rellenamos los textos de Hacienda/SS desde ui.js para mantener coherencia
        window.onload = function() {
            if (typeof UI !== 'undefined') {
                const pHacienda = document.querySelector('#seccion_hacienda p');
                if (pHacienda) pHacienda.innerHTML = UI.textos.haciendaInfo;
            }
        };

        function togglePagasExtra() {
            const tipo = document.getElementById('f_pagas_tipo').value;
            document.getElementById('f_bloque_pagas').style.display = (tipo === 'no') ? 'block' : 'none';
        }

        function calcularLiquidacion() {
            const sMes = parseFloat(document.getElementById('f_salario_mes').value) || 0;
            const diasMes = parseFloat(document.getElementById('f_dias_mes').value) || 0;
            const vacDias = parseFloat(document.getElementById('f_vac_dias').value) || 0;
            const mesesPaga = parseFloat(document.getElementById('f_meses_paga').value) || 0;
            const sDia = sMes / 30;

            const impDias = sDia * diasMes;
            const impVac = sDia * vacDias;
            const impExtra = (sMes / 6) * mesesPaga;

            const total = impDias + impVac + (document.getElementById('f_pagas_tipo').value === 'no' ? impExtra : 0);

            let html = `
                <div class="res-item-finiquito"><span>Días trabajados mes actual:</span> <strong>${UI.formatEuro(impDias)}</strong></div>
                <div class="res-item-finiquito"><span>Vacaciones no disfrutadas:</span> <strong>${UI.formatEuro(impVac)}</strong></div>
            `;
            
            if (document.getElementById('f_pagas_tipo').value === 'no') {
                html += `<div class="res-item-finiquito"><span>Paga Extra (Parte proporcional):</span> <strong>${UI.formatEuro(impExtra)}</strong></div>`;
            }

            document.getElementById('f_lista').innerHTML = html;
            document.getElementById('f_total').innerText = UI.formatEuro(total);
            document.getElementById('f_resultado').style.display = 'block';
            document.getElementById('f_resultado').scrollIntoView({ behavior: 'smooth' });
        }
    </script>
</body>
</html>
