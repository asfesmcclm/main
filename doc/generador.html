<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <title>Generador de Permisos - FeSMC UGT CLM</title>
    <style>
        :root{
            --color-principal: #e30613; 
            --color-secundario: #f8f9fa;
            --color-texto: #2d3436;
            --color-acento: #c40511;
            --color-output-bg: #fffef9;
            --max-width: 1300px;
        }
        *,*::before,*::after{box-sizing:border-box}
        body{
            font-family: 'Segoe UI', system-ui, sans-serif;
            margin:0; padding:0; color:var(--color-texto);
            background:var(--color-secundario);
        }
        .container{
            max-width:var(--max-width); margin:20px auto; padding:25px;
            background:#fff; border-radius:15px; box-shadow: 0 4px 20px rgba(0,0,0,0.08);
        }
        .btn-volver {
            display: inline-flex; align-items: center; padding: 10px 18px;
            background: #636e72; color: white; text-decoration: none;
            border-radius: 8px; font-size: 0.9rem; margin-bottom: 20px; font-weight: 600;
        }
        header{ text-align:center; border-bottom:4px solid var(--color-principal); padding-bottom:20px; margin-bottom:20px; }
        header h1{ color:var(--color-principal); font-size:clamp(1.2rem,3vw,2rem); margin:0; text-transform: uppercase;}
        
        #aviso-legal-importante{
            background:#fff8f8; color:#b02a37; border:1px solid #f5c2c7;
            border-left:5px solid var(--color-principal); padding:15px; border-radius:10px; margin-bottom:20px; font-size: 0.85rem;
        }
        .main-content-wrapper{ display:flex; flex-wrap:wrap; gap:25px; }
        #indice-panel{ flex:0 0 320px; }
        #action-form-panel{ flex:1; min-width:300px; }
        #right-panel{ flex:2; min-width:350px; }

        #indice{ background:#fff; padding:15px; border-radius:12px; border: 1px solid #eee; }
        #indice ul{ list-style:none; padding:0; }
        #indice li{ margin-bottom:8px; }
        #indice a{ 
            text-decoration:none; color:var(--color-texto); display:block; padding:10px; 
            border-radius:8px; transition: 0.2s; cursor:pointer; border: 1px solid transparent; font-size: 0.9rem;
        }
        #indice a:hover{ background:#fff0f0; color:var(--color-principal); border-color: #f5c2c7; }

        .flow-button{
            width: 100%; margin-bottom: 10px; padding:14px; border-radius:10px; border:none; 
            cursor:pointer; font-weight:700; transition: 0.2s;
        }
        .primary-button{ background:var(--color-principal); color:#fff; }
        .secondary-button{ background:#636e72; color:#fff; }
        
        .form-group{ margin-bottom:12px; }
        .form-group label{ display:block; font-weight:600; margin-bottom:5px; font-size:0.85rem; }
        .form-group input{ width:100%; padding:10px; border-radius:8px; border:1px solid #dfe6e9; background: #fdfdfd;}

        #code-output-container{ border:2px solid #eee; border-radius:12px; background:var(--color-output-bg); }
        #code-output{ white-space:pre-wrap; padding:30px; font-family: 'Georgia', serif; line-height:1.6; font-size: 1.05rem; color: #1a1a1a; }
        .hidden{ display: none; }
        
        @media (max-width: 900px) {
            .main-content-wrapper { flex-direction: column; }
            #indice-panel, #action-form-panel, #right-panel { flex: 1 1 auto; width: 100%; }
        }
    </style>
</head>
<body>
    <div class="container">
        <a href="../index.html" class="btn-volver">‚Üê Volver al Panel</a>
        <header>
            <h1>Generador de Escritos Laborales UGT</h1>
        </header>
        
        <div id="aviso-legal-importante">
            <p><strong>üö® IMPORTANTE:</strong> Estos modelos son orientativos. La normativa o los plazos pueden variar seg√∫n tu <strong>Convenio Colectivo</strong>. Antes de entregarlos, consulta con tu secci√≥n sindical o delegados de <strong>FeSMC UGT CLM</strong>.</p>
        </div>

        <main class="main-content-wrapper">
            <section id="indice-panel">
                <nav id="indice">
                    <ul id="indice-lista"></ul>
                </nav>
            </section>

            <section id="action-form-panel">
                <div id="action-flow-container" class="hidden">
                    <h3 id="action-title" style="color:var(--color-principal); font-size: 1.1rem;"></h3>
                    <div id="selection-buttons">
                        <button id="btn-show-form" class="flow-button primary-button">Rellenar Datos Personalizados</button>
                        <button id="btn-generate-blank" class="flow-button secondary-button">Ver Modelo en Blanco</button>
                    </div>
                    <div id="dynamic-form-wrapper" class="hidden">
                        <form id="dynamic-form"></form>
                        <button id="btn-generar" class="flow-button primary-button">Generar Escrito Final</button>
                    </div>
                </div>
            </section>

            <section id="right-panel">
                <div id="code-output-container">
                    <div id="code-output">Selecciona un modelo del √≠ndice para comenzar...</div>
                </div>
                <div id="final-actions" class="hidden">
                    <button id="btn-copiar" class="flow-button primary-button" style="margin-top:15px;">Copiar al Portapapeles</button>
                </div>
            </section>
        </main>
    </div>

    <script>
        function formatDate(date) {
            if (!date) return "";
            const [y, m, d] = date.split('-');
            return d ? `${d}/${m}/${y}` : date;
        }

        const ModelosData = {
            'm1': {
                titulo: '1. Permiso Parental (8 Semanas) - Art. 48.bis ET',
                campos: [{id:'empresa', label:'Empresa'}, {id:'loc', label:'Localidad'}, {id:'fecha', label:'Fecha Comunicaci√≥n', tipo:'date'}, {id:'nombre', label:'Nombre Trabajador'}, {id:'dni', label:'DNI'}, {id:'hijo', label:'F. Nacimiento Hijo', tipo:'date'}, {id:'i1', label:'Inicio 1¬∫ Periodo', tipo:'date'}, {id:'f1', label:'Fin 1¬∫ Periodo', tipo:'date'}, {id:'sem', label:'N¬∫ Semanas'}],
                plantilla: (d) => `A la Direcci√≥n de la empresa: ${d.empresa}\nEn ${d.loc}, a ${formatDate(d.fecha)}\n\nAsunto: Comunicaci√≥n de disfrute de Permiso Parental (Art. 48.bis ET)\n\nEstimados Sres.:\n\nD√±a./D. ${d.nombre} con DNI ${d.dni}, como trabajador/a de la empresa, les comunico que, en virtud de lo dispuesto en el art. 48.bis del Estatuto de los Trabajadores, disfrutar√© del permiso parental para el cuidado de mi hijo/a nacido/a el ${formatDate(d.hijo)}.\n\nLos per√≠odos de disfrute ser√°n los siguientes:\n* Del ${formatDate(d.i1)} al ${formatDate(d.f1)} (Total: ${d.sem} semanas).\n\nLo que se comunica con la antelaci√≥n m√≠nima legal de diez d√≠as.\n\nAtentamente,\nFdo: ${d.nombre}`
            },
            'm2': {
                titulo: '2. Adaptaci√≥n de Puesto (Art. 25 LPRL)',
                campos: [{id:'empresa', label:'Empresa'}, {id:'dir', label:'Direcci√≥n Centro'}, {id:'loc', label:'Localidad'}, {id:'fecha', label:'Fecha', tipo:'date'}, {id:'nombre', label:'Nombre'}, {id:'dni', label:'DNI'}],
                plantilla: (d) => `A LA DIRECCI√ìN DE RRHH DE ${d.empresa}\n${d.dir}\n${d.loc}, ${formatDate(d.fecha)}\n\nAsunto: Solicitud de Adaptaci√≥n de Puesto por Especial Sensibilidad\n\nEstimados se√±ores:\n\nD./D√±a.: ${d.nombre} con DNI: ${d.dni}\n\nEn coherencia con el art√≠culo 25.1 de la Ley 31/1995 de Prevenci√≥n de Riesgos Laborales, considero que mi puesto actual puede afectar negativamente a mi salud. Por ello SOLICITO:\n1. Que el Servicio de Prevenci√≥n reeval√∫e mi situaci√≥n personal.\n2. Que se proceda a la adaptaci√≥n de las condiciones de mi puesto.\n\nAtentamente,\nFdo: ${d.nombre}`
            },
            'm3': {
                titulo: '3. Hospitalizaci√≥n Reci√©n Nacido - Art. 37.4 ET',
                campos: [{id:'empresa', label:'Empresa'}, {id:'loc', label:'Localidad'}, {id:'fecha', label:'Fecha', tipo:'date'}, {id:'nombre', label:'Nombre'}, {id:'dni', label:'DNI'}, {id:'inicio', label:'Fecha Inicio Ausencia', tipo:'date'}, {id:'h1', label:'Hora Inicio'}, {id:'h2', label:'Hora Fin'}],
                plantilla: (d) => `A la Direcci√≥n de RRHH de ${d.empresa}\nEn ${d.loc}, a ${formatDate(d.fecha)}\n\nAsunto: Comunicaci√≥n de Ausencia por Hospitalizaci√≥n de Reci√©n Nacido (Art. 37.4 ET)\n\nD./D√±a. ${d.nombre}, con DNI ${d.dni}, les comunico que, encontr√°ndose mi hijo/a hospitalizado/a tras el parto, me ausentar√© del puesto durante una hora cada d√≠a.\n\nEsta ausencia se har√° efectiva a partir del ${formatDate(d.inicio)} en horario de ${d.h1} a ${d.h2}. Adjunto justificante.\n\nAtentamente,\nFdo: ${d.nombre}`
            },
            'm4': {
                titulo: '4. Ex√°menes Prenatales - Art. 37.3.f ET',
                campos: [{id:'empresa', label:'Empresa'}, {id:'loc', label:'Localidad'}, {id:'fecha', label:'Fecha', tipo:'date'}, {id:'nombre', label:'Nombre'}, {id:'aus', label:'D√≠a de Ausencia', tipo:'date'}, {id:'h1', label:'Hora Inicio'}, {id:'h2', label:'Hora Fin'}, {id:'cita', label:'Tipo de Cita'}],
                plantilla: (d) => `A la Direcci√≥n de RRHH de ${d.empresa}\nEn ${d.loc}, a ${formatDate(d.fecha)}\n\nAsunto: Comunicaci√≥n de Ausencia Retribuida (Ex√°menes Prenatales)\n\nDo√±a ${d.nombre}, con DNI ${d.dni}, en estado de gestaci√≥n, comunica que seg√∫n el Art. 37.3.f del ET, me ausentar√© el d√≠a ${formatDate(d.aus)} de ${d.h1} a ${d.h2} para asistir a: ${d.cita}.\n\nSe adjunta justificante m√©dico.\n\nAtentamente,\nFdo: ${d.nombre}`
            },
            'm5': {
                titulo: '5. Excedencia Voluntaria - Art. 46.2 ET',
                campos: [{id:'empresa', label:'Empresa'}, {id:'loc', label:'Localidad'}, {id:'fecha', label:'Fecha', tipo:'date'}, {id:'nombre', label:'Nombre'}, {id:'dni', label:'DNI'}, {id:'ant', label:'Fecha Antig√ºedad', tipo:'date'}, {id:'dur', label:'Duraci√≥n (ej. 1 a√±o)'}, {id:'inicio', label:'F. Inicio', tipo:'date'}, {id:'fin', label:'F. Fin prevista', tipo:'date'}],
                plantilla: (d) => `A LA EMPRESA: ${d.empresa}\nEn ${d.loc} a ${formatDate(d.fecha)}\n\nAsunto: Solicitud de Excedencia Voluntaria (Art. 46.2 ET)\n\nYo ${d.nombre} con DNI ${d.dni}, trabajador/a con antig√ºedad desde el ${formatDate(d.ant)}, solicito mi paso a situaci√≥n de EXCEDENCIA VOLUNTARIA.\n\nLa duraci√≥n ser√° de ${d.dur}, inici√°ndose el ${formatDate(d.inicio)} y finalizando el ${formatDate(d.fin)}.\n\nAtentamente,\nFdo: ${d.nombre}`
            },
            'm6': {
                titulo: '6. Formaci√≥n (20 Horas) - Art. 23.3 ET',
                campos: [{id:'empresa', label:'Empresa'}, {id:'loc', label:'Localidad'}, {id:'fecha', label:'Fecha', tipo:'date'}, {id:'nombre', label:'Nombre'}, {id:'horas', label:'N¬∫ Horas (m√°x 20)'}, {id:'curso', label:'Nombre del Curso'}, {id:'i', label:'F. Inicio', tipo:'date'}, {id:'f', label:'F. Fin', tipo:'date'}],
                plantilla: (d) => `A RRHH DE ${d.empresa}\nEn ${d.loc} a ${formatDate(d.fecha)}\n\nAsunto: Solicitud de Permiso Retribuido para Formaci√≥n (Art. 23.3 ET)\n\nD./D√±a. ${d.nombre} solicita el disfrute de ${d.horas} horas para realizar el curso ${d.curso}, desde el ${formatDate(d.i)} al ${formatDate(d.f)}.\n\nAtentamente,\nFdo: ${d.nombre}`
            },
            'm7': {
                titulo: '7. Fin Lactancia y Retorno - Art. 37.4 ET',
                campos: [{id:'empresa', label:'Empresa'}, {id:'loc', label:'Localidad'}, {id:'fecha', label:'Fecha', tipo:'date'}, {id:'nombre', label:'Nombre'}, {id:'dni', label:'DNI'}, {id:'mod', label:'Modalidad actual'}, {id:'f_fin', label:'Fecha Fin Permiso', tipo:'date'}, {id:'f_ret', label:'Fecha Retorno', tipo:'date'}],
                plantilla: (d) => `A la Direcci√≥n de RRHH de ${d.empresa}\nEn ${d.loc}, a ${formatDate(d.fecha)}\n\nAsunto: Preaviso de Finalizaci√≥n de Permiso de Lactancia\n\nD./D√±a. ${d.nombre}, con DNI ${d.dni}, comunica que habiendo disfrutado del permiso de lactante en modalidad de ${d.mod}, el mismo finalizar√° el ${formatDate(d.f_fin)}.\n\nPor tanto, el ${formatDate(d.f_ret)} me reincorporar√© a mi jornada ordinaria.\n\nAtentamente,\nFdo: ${d.nombre}`
            },
            'm8': {
                titulo: '8. Lactancia Acumulada - Art. 37.4 ET',
                campos: [{id:'empresa', label:'Empresa'}, {id:'loc', label:'Localidad'}, {id:'fecha', label:'Fecha', tipo:'date'}, {id:'nombre', label:'Nombre'}, {id:'dni', label:'DNI'}, {id:'i', label:'Inicio Acumulado', tipo:'date'}, {id:'f', label:'Fin Acumulado', tipo:'date'}, {id:'dias', label:'D√≠as Laborables Totales'}],
                plantilla: (d) => `A la Direcci√≥n de RRHH de ${d.empresa}\nEn ${d.loc}, a ${formatDate(d.fecha)}\n\nAsunto: Comunicaci√≥n de Acumulaci√≥n de Permiso de Lactancia\n\nD./D√±a. ${d.nombre} comunica su intenci√≥n de acumular el permiso por cuidado de lactante en jornadas completas del ${formatDate(d.i)} al ${formatDate(d.f)}, lo que supone un total de ${d.dias} d√≠as laborables.\n\nAtentamente,\nFdo: ${d.nombre}`
            },
            'm9': {
                titulo: '9. Adaptaci√≥n de Jornada - Art. 34.8 ET',
                campos: [{id:'empresa', label:'Empresa'}, {id:'loc', label:'Localidad'}, {id:'fecha', label:'Fecha', tipo:'date'}, {id:'nombre', label:'Nombre'}, {id:'motivo', label:'Motivo Conciliaci√≥n'}, {id:'det', label:'Nueva Jornada Propuesta'}, {id:'inicio', label:'Fecha Inicio', tipo:'date'}],
                plantilla: (d) => `A la Direcci√≥n de RRHH de ${d.empresa}\nEn ${d.loc}, a ${formatDate(d.fecha)}\n\nAsunto: Solicitud de Adaptaci√≥n de Jornada de Trabajo (Art. 34.8 ET)\n\nD./D√±a. ${d.nombre} solicita la adaptaci√≥n de su jornada por ${d.motivo}.\n\nPropuesta: ${d.det}.\nInicio: ${formatDate(d.inicio)}.\n\nQuedo a la espera de su respuesta en el plazo legal de 15 d√≠as.\n\nAtentamente,\nFdo: ${d.nombre}`
            },
            'm10': {
                titulo: '10. Excedencia Cuidado Hijo - Art. 46.3 ET',
                campos: [{id:'loc', label:'Localidad'}, {id:'fecha', label:'Fecha', tipo:'date'}, {id:'nombre', label:'Nombre'}, {id:'dni', label:'DNI'}, {id:'nac', label:'F. Nacimiento Hijo', tipo:'date'}, {id:'dur', label:'Duraci√≥n'}, {id:'inicio', label:'Fecha Inicio', tipo:'date'}],
                plantilla: (d) => `En ${d.loc} a ${formatDate(d.fecha)}\n\nAsunto: Solicitud de Excedencia por Cuidado de Hijo (Art. 46.3 ET)\n\nD./D√±a. ${d.nombre}, con DNI ${d.dni}, solicita su paso a excedencia por cuidado de hijo/a nacido/a el ${formatDate(d.nac)}.\n\nDuraci√≥n solicitada: ${d.dur}, a partir del d√≠a ${formatDate(d.inicio)}.\n\nAtentamente,\nFdo: ${d.nombre}`
            },
            'm11': {
                titulo: '11. Pr√≥rroga Excedencia Familiar - Art. 46.3 ET',
                campos: [{id:'empresa', label:'Empresa'}, {id:'loc', label:'Localidad'}, {id:'fecha', label:'Fecha', tipo:'date'}, {id:'nombre', label:'Nombre'}, {id:'dni', label:'DNI'}, {id:'par', label:'Parentesco Familiar'}, {id:'i_or', label:'Inicio Excedencia Original', tipo:'date'}, {id:'dur', label:'Duraci√≥n Pr√≥rroga'}, {id:'i_pr', label:'Inicio Pr√≥rroga', tipo:'date'}],
                plantilla: (d) => `A la Direcci√≥n de RRHH de ${d.empresa}\nEn ${d.loc}, a ${formatDate(d.fecha)}\n\nAsunto: Solicitud de Pr√≥rroga de Excedencia por Cuidado de Familiar\n\nD./D√±a. ${d.nombre} solicita la pr√≥rroga de la excedencia por cuidado de su ${d.par} iniciada el ${formatDate(d.i_or)}. La pr√≥rroga ser√° de ${d.dur}, inici√°ndose el ${formatDate(d.i_pr)}.\n\nAtentamente,\nFdo: ${d.nombre}`
            },
            'm12': {
                titulo: '12. Reducci√≥n Jornada Guarda - Art. 37.6 ET',
                campos: [{id:'empresa', label:'Empresa'}, {id:'loc', label:'Localidad'}, {id:'fecha', label:'Fecha', tipo:'date'}, {id:'nombre', label:'Nombre'}, {id:'dni', label:'DNI'}, {id:'frac', label:'Fracci√≥n (ej. 1/3)'}, {id:'h1', label:'Hora Inicio'}, {id:'h2', label:'Hora Fin'}, {id:'inicio', label:'Fecha Inicio', tipo:'date'}],
                plantilla: (d) => `A la Direcci√≥n de RRHH de ${d.empresa}\nEn ${d.loc}, a ${formatDate(d.fecha)}\n\nAsunto: Solicitud de Reducci√≥n de Jornada por Guarda Legal (Art. 37.6 ET)\n\nD./D√±a. ${d.nombre} solicita una reducci√≥n de jornada de ${d.frac}.\n\nNuevo horario: De ${d.h1} a ${d.h2}.\nFecha de inicio: ${formatDate(d.inicio)}.\n\nAtentamente,\nFdo: ${d.nombre}`
            },
            'm13': {
                titulo: '13. Nacimiento y Cuidado (19 Semanas) - Art. 48.4 ET',
                campos: [{id:'empresa', label:'Empresa'}, {id:'loc', label:'Localidad'}, {id:'fecha', label:'Fecha', tipo:'date'}, {id:'nombre', label:'Nombre'}, {id:'dni', label:'DNI'}, {id:'nac', label:'F. Nacimiento', tipo:'date'}, {id:'i_oblig', label:'Inicio 6 sem. obligatorias', tipo:'date'}, {id:'f_oblig', label:'Fin 6 sem. obligatorias', tipo:'date'}],
                plantilla: (d) => `A la Direcci√≥n de RRHH de ${d.empresa}\nEn ${d.loc}, a ${formatDate(d.fecha)}\n\nAsunto: Solicitud de Permiso por Nacimiento y Cuidado del Menor (19 Semanas)\n\nD./D√±a. ${d.nombre} comunica que en fecha ${formatDate(d.nac)} tuvo lugar el nacimiento/adopci√≥n de su hijo/a.\n\nDe acuerdo con el Art. 48.4 del ET, disfrutar√© del periodo obligatorio de 6 semanas del ${formatDate(d.i_oblig)} al ${formatDate(d.f_oblig)}. El resto de semanas se comunicar√°n con la antelaci√≥n debida.\n\nAtentamente,\nFdo: ${d.nombre}`
            }
        };

        const lista = document.getElementById('indice-lista');
        const output = document.getElementById('code-output');
        let sel = null;

        Object.keys(ModelosData).forEach(id => {
            const li = document.createElement('li');
            li.innerHTML = `<a onclick="cargar('${id}')">${ModelosData[id].titulo}</a>`;
            lista.appendChild(li);
        });

        function cargar(id) {
            sel = id;
            document.getElementById('action-flow-container').classList.remove('hidden');
            document.getElementById('action-title').innerText = ModelosData[id].titulo;
            document.getElementById('dynamic-form-wrapper').classList.add('hidden');
            document.getElementById('selection-buttons').classList.remove('hidden');
            document.getElementById('final-actions').classList.add('hidden');
            output.innerText = "Selecciona 'Rellenar Datos' para personalizar el escrito o 'Ver Modelo en Blanco' para copiar la estructura.";
        }

        document.getElementById('btn-show-form').onclick = () => {
            document.getElementById('selection-buttons').classList.add('hidden');
            document.getElementById('dynamic-form-wrapper').classList.remove('hidden');
            const f = document.getElementById('dynamic-form');
            f.innerHTML = '';
            ModelosData[sel].campos.forEach(c => {
                f.innerHTML += `<div class="form-group"><label>${c.label}</label><input type="${c.tipo||'text'}" id="i-${c.id}" autocomplete="off"></div>`;
            });
        };

        document.getElementById('btn-generate-blank').onclick = () => {
            const d = {};
            ModelosData[sel].campos.forEach(c => d[c.id] = `[${c.label.toUpperCase()}]`);
            output.innerText = ModelosData[sel].plantilla(d);
            document.getElementById('final-actions').classList.remove('hidden');
        };

        document.getElementById('btn-generar').onclick = () => {
            const d = {};
            ModelosData[sel].campos.forEach(c => {
                const v = document.getElementById(`i-${c.id}`).value;
                d[c.id] = v ? v : `[${c.label}]`;
            });
            output.innerText = ModelosData[sel].plantilla(d);
            document.getElementById('final-actions').classList.remove('hidden');
        };

        document.getElementById('btn-copiar').onclick = () => {
            navigator.clipboard.writeText(output.innerText).then(() => {
                alert("Texto copiado. Ya puedes pegarlo en un documento Word o en un correo.");
            });
        };
    </script>
</body>
</html>
